/*
	// DischargedonAntithromboticTherapy lines [8:1-8:94]
	valueset "Antithrombotic Therapy for Ischemic Stroke": 'urn:oid:2.16.840.1.113762.1.4.1110.62'
*/
{% macro DischargedonAntithromboticTherapyAntithrombotic_Therapy_for_Ischemic_Stroke() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1110.62', 'referenceName': 'DischargedonAntithromboticTherapyAntithrombotic Therapy for Ischemic Stroke' }{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [9:1-9:58]
	valueset "Ethnicity": 'urn:oid:2.16.840.1.114222.4.11.837'
*/
{% macro DischargedonAntithromboticTherapyEthnicity() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.114222.4.11.837', 'referenceName': 'DischargedonAntithromboticTherapyEthnicity' }{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [10:1-10:98]
	valueset "Medical Reason For Not Providing Treatment": 'urn:oid:2.16.840.1.113883.3.117.1.7.1.473'
*/
{% macro DischargedonAntithromboticTherapyMedical_Reason_For_Not_Providing_Treatment() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.473', 'referenceName': 'DischargedonAntithromboticTherapyMedical Reason For Not Providing Treatment' }{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [11:1-11:68]
	valueset "ONC Administrative Sex": 'urn:oid:2.16.840.1.113762.1.4.1'
*/
{% macro DischargedonAntithromboticTherapyONC_Administrative_Sex() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1', 'referenceName': 'DischargedonAntithromboticTherapyONC Administrative Sex' }{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [12:1-12:70]
	valueset "Patient Refusal": 'urn:oid:2.16.840.1.113883.3.117.1.7.1.93'
*/
{% macro DischargedonAntithromboticTherapyPatient_Refusal() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.93', 'referenceName': 'DischargedonAntithromboticTherapyPatient Refusal' }{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [13:1-13:55]
	valueset "Payer": 'urn:oid:2.16.840.1.114222.4.11.3591'
*/
{% macro DischargedonAntithromboticTherapyPayer() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.114222.4.11.3591', 'referenceName': 'DischargedonAntithromboticTherapyPayer' }{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [14:1-14:112]
	valueset "Pharmacological Contraindications For Antithrombotic Therapy": 'urn:oid:2.16.840.1.113762.1.4.1110.52'
*/
{% macro DischargedonAntithromboticTherapyPharmacological_Contraindications_For_Antithrombotic_Therapy() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1110.52', 'referenceName': 'DischargedonAntithromboticTherapyPharmacological Contraindications For Antithrombotic Therapy' }{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [15:1-15:53]
	valueset "Race": 'urn:oid:2.16.840.1.114222.4.11.836'
*/
{% macro DischargedonAntithromboticTherapyRace() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.114222.4.11.836', 'referenceName': 'DischargedonAntithromboticTherapyRace' }{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [17:1-17:15]
	context Patient
*/
{% macro DischargedonAntithromboticTherapyPatient(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapyPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } }) }}{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [19:1-20:51]
	define "SDE Ethnicity":
	  ["Patient Characteristic Ethnicity": "Ethnicity"]
*/
{% macro DischargedonAntithromboticTherapySDE_Ethnicity(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapySDE Ethnicity', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': none, 'resultTypeLabel': 'Patient Characteristic Ethnicity', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyEthnicity', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.114222.4.11.837', 'referenceName': 'DischargedonAntithromboticTherapyEthnicity' } } } }) }}{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [22:1-23:43]
	define "SDE Payer":
	  ["Patient Characteristic Payer": "Payer"]
*/
{% macro DischargedonAntithromboticTherapySDE_Payer(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapySDE Payer', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': none, 'resultTypeLabel': 'Patient Characteristic Payer', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyPayer', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.114222.4.11.3591', 'referenceName': 'DischargedonAntithromboticTherapyPayer' } } } }) }}{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [25:1-26:41]
	define "SDE Race":
	  ["Patient Characteristic Race": "Race"]
*/
{% macro DischargedonAntithromboticTherapySDE_Race(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapySDE Race', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': none, 'resultTypeLabel': 'Patient Characteristic Race', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyRace', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.114222.4.11.836', 'referenceName': 'DischargedonAntithromboticTherapyRace' } } } }) }}{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [28:1-29:58]
	define "SDE Sex":
	  ["Patient Characteristic Sex": "ONC Administrative Sex"]
*/
{% macro DischargedonAntithromboticTherapySDE_Sex(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapySDE Sex', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': none, 'resultTypeLabel': 'Patient Characteristic Sex', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyONC_Administrative_Sex', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1', 'referenceName': 'DischargedonAntithromboticTherapyONC Administrative Sex' } } } }) }}{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [31:1-32:33]
	define "Denominator":
	  TJC."Ischemic Stroke Encounter"
*/
{% macro DischargedonAntithromboticTherapyDenominator(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapyDenominator', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallIschemic_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIschemic Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } }, 'right': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'EncounterWithAge', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'EncounterWithAge', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallEncounter_with_Principal_Diagnosis_and_Age', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Principal Diagnosis and Age', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.GreaterOrEqual, 'left': { 'operator': environment.CalculateAgeAt, 'left': { 'operator': environment.ToDate, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'birthDatetime', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallPatient', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } } } } }, 'right': { 'operator': environment.DateFrom, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'AllStrokeEncounter', 'path': 'relevantPeriod' } } } }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '18' } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'AllStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallAll_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } } } }] } } } }] } } } }) }}{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [34:1-35:50]
	define "Initial Population":
	  TJC."Encounter with Principal Diagnosis and Age"
*/
{% macro DischargedonAntithromboticTherapyInitial_Population(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapyInitial Population', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallEncounter_with_Principal_Diagnosis_and_Age', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Principal Diagnosis and Age', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.GreaterOrEqual, 'left': { 'operator': environment.CalculateAgeAt, 'left': { 'operator': environment.ToDate, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'birthDatetime', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallPatient', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } } } } }, 'right': { 'operator': environment.DateFrom, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'AllStrokeEncounter', 'path': 'relevantPeriod' } } } }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '18' } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'AllStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallAll_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } } } }] } } } }) }}{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [37:1-39:70]
	define "Denominator Exclusions":
	  TJC."Ischemic Stroke Encounters with Discharge Disposition"
	    union TJC."Encounter with Comfort Measures during Hospitalization"
*/
{% macro DischargedonAntithromboticTherapyDenominator_Exclusions(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapyDenominator Exclusions', 'child': { 'operator': environment.Union, 'mixed': 'false', 'children': [{ 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallIschemic_Stroke_Encounters_with_Discharge_Disposition', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIschemic Stroke Encounters with Discharge Disposition', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Or, 'left': { 'operator': environment.Or, 'left': { 'operator': environment.Or, 'left': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'dischargeDisposition' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallDischarge_To_Acute_Care_Facility', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.87', 'referenceName': 'TJCOverallDischarge To Acute Care Facility' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'dischargeDisposition' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallLeft_Against_Medical_Advice', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.308', 'referenceName': 'TJCOverallLeft Against Medical Advice' } } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'dischargeDisposition' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallPatient_Expired', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.309', 'referenceName': 'TJCOverallPatient Expired' } } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'dischargeDisposition' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallDischarged_to_Home_for_Hospice_Care', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.209', 'referenceName': 'TJCOverallDischarged to Home for Hospice Care' } } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'dischargeDisposition' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallDischarged_to_Health_Care_Facility_for_Hospice_Care', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.207', 'referenceName': 'TJCOverallDischarged to Health Care Facility for Hospice Care' } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'IschemicStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallIschemic_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIschemic Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } }, 'right': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'EncounterWithAge', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'EncounterWithAge', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallEncounter_with_Principal_Diagnosis_and_Age', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Principal Diagnosis and Age', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.GreaterOrEqual, 'left': { 'operator': environment.CalculateAgeAt, 'left': { 'operator': environment.ToDate, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'birthDatetime', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallPatient', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } } } } }, 'right': { 'operator': environment.DateFrom, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'AllStrokeEncounter', 'path': 'relevantPeriod' } } } }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '18' } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'AllStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallAll_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } } } }] } } } }] } } } }] } } }, { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallEncounter_with_Comfort_Measures_during_Hospitalization', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Comfort Measures during Hospitalization', 'child': { 'operator': environment.Query, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'IschemicStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallIschemic_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIschemic Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } }, 'right': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'EncounterWithAge', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'EncounterWithAge', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallEncounter_with_Principal_Diagnosis_and_Age', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Principal Diagnosis and Age', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.GreaterOrEqual, 'left': { 'operator': environment.CalculateAgeAt, 'left': { 'operator': environment.ToDate, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'birthDatetime', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallPatient', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } } } } }, 'right': { 'operator': environment.DateFrom, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'AllStrokeEncounter', 'path': 'relevantPeriod' } } } }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '18' } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'AllStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallAll_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } } } }] } } } }] } } } }], 'relationshipClauseList': [{ 'operator': environment.With, 'alias': 'ComfortMeasure', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallIntervention_Comfort_Measures', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIntervention Comfort Measures', 'child': { 'operator': environment.Union, 'mixed': 'true', 'children': [{ 'operator': environment.As, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveInterventionOrder', 'resultTypeLabel': 'Intervention, Order', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallComfort_Measures', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:1.3.6.1.4.1.33895.1.3.0.45', 'referenceName': 'TJCOverallComfort Measures' } } }, 'typeSpecifier': { 'operator': environment.ListTypeSpecifier, 'children': [{ 'operator': environment.ChoiceTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveInterventionPerformed' }, { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveInterventionOrder' }] }] } }, { 'operator': environment.As, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveInterventionPerformed', 'resultTypeLabel': 'Intervention, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallComfort_Measures', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:1.3.6.1.4.1.33895.1.3.0.45', 'referenceName': 'TJCOverallComfort Measures' } } }, 'typeSpecifier': { 'operator': environment.ListTypeSpecifier, 'children': [{ 'operator': environment.ChoiceTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveInterventionPerformed' }, { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveInterventionOrder' }] }] } }] } } }, 'suchThat': { 'operator': environment.InInterval, 'left': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsNormalizeInterval', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsNormalizeInterval', 'child': { 'operator': environment.If, 'condition': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.OperandRef, 'referencedName': 'pointInTime', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'pointInTime', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } } }, 'then': { 'operator': environment.Interval, 'high': { 'operator': environment.OperandRef, 'referencedName': 'pointInTime', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'pointInTime', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } }, 'low': { 'operator': environment.OperandRef, 'referencedName': 'pointInTime', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'pointInTime', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } }, 'else': { 'operator': environment.If, 'condition': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.OperandRef, 'referencedName': 'period', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'period', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'then': { 'operator': environment.OperandRef, 'referencedName': 'period', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'period', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } }, 'else': { 'operator': environment.As, 'child': { 'operator': environment.Null }, 'typeSpecifier': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'typeSpecifier': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'pointInTime', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } }, { 'operator': environment.OperandDef, 'referenceName': 'period', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'ComfortMeasure', 'path': 'relevantDatetime' }, { 'operator': environment.Property, 'scope': 'ComfortMeasure', 'path': 'relevantPeriod' }] } }, { 'operator': environment.Property, 'scope': 'ComfortMeasure', 'path': 'authorDatetime' }] }, 'right': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsHospitalizationWithObservation', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsHospitalizationWithObservation', 'child': { 'operator': environment.Query, 'returnClause': { 'operator': environment.ReturnClause, 'child': { 'operator': environment.Interval, 'high': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'EDVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'EDVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastED', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastED', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsEmergency_Department_Visit', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.292', 'referenceName': 'MATGlobalCommonFunctionsEmergency Department Visit' } } } }] } } } } } }, { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }] } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Visit', 'child': { 'operator': environment.OperandRef, 'referencedName': 'Encounter', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Encounter', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed' } } } }], 'letClauseList': [{ 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } }, { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } }, { 'operator': environment.LetClause, 'referenceName': 'EDVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastED', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastED', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsEmergency_Department_Visit', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.292', 'referenceName': 'MATGlobalCommonFunctionsEmergency Department Visit' } } } }] } } }] }, 'typeSpecifier': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Encounter', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed' } }] }, 'children': [{ 'operator': environment.AliasRef, 'referencedName': 'IschemicStrokeEncounter' }] } } }], 'aliasRefNodeList': [{ 'operator': environment.AliasRef, 'referencedName': 'IschemicStrokeEncounter' }] } } }] } }) }}{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [41:1-44:92]
	define "Encounter with Pharmacological Contraindications for Antithrombotic Therapy at Discharge":
	  TJC."Ischemic Stroke Encounter" IschemicStrokeEncounter
	    with ["Medication, Discharge": "Pharmacological Contraindications For Antithrombotic Therapy"] Pharmacological
	      such that Pharmacological.authorDatetime during IschemicStrokeEncounter.relevantPeriod
*/
{% macro DischargedonAntithromboticTherapyEncounter_with_Pharmacological_Contraindications_for_Antithrombotic_Therapy_at_Discharge(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapyEncounter with Pharmacological Contraindications for Antithrombotic Therapy at Discharge', 'child': { 'operator': environment.Query, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'IschemicStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallIschemic_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIschemic Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } }, 'right': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'EncounterWithAge', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'EncounterWithAge', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallEncounter_with_Principal_Diagnosis_and_Age', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Principal Diagnosis and Age', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.GreaterOrEqual, 'left': { 'operator': environment.CalculateAgeAt, 'left': { 'operator': environment.ToDate, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'birthDatetime', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallPatient', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } } } } }, 'right': { 'operator': environment.DateFrom, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'AllStrokeEncounter', 'path': 'relevantPeriod' } } } }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '18' } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'AllStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallAll_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } } } }] } } } }] } } } }], 'relationshipClauseList': [{ 'operator': environment.With, 'alias': 'Pharmacological', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveMedicationDischarge', 'resultTypeLabel': 'Medication, Discharge', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyPharmacological_Contraindications_For_Antithrombotic_Therapy', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1110.52', 'referenceName': 'DischargedonAntithromboticTherapyPharmacological Contraindications For Antithrombotic Therapy' } } }, 'suchThat': { 'operator': environment.InInterval, 'left': { 'operator': environment.Property, 'scope': 'Pharmacological', 'path': 'authorDatetime' }, 'right': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'relevantPeriod' } } }] } }) }}{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [46:1-49:73]
	define "Reason for Not Giving Antithrombotic at Discharge":
	  ["Medication, Not Discharged": "Antithrombotic Therapy for Ischemic Stroke"] NoAntithromboticDischarge
	    where NoAntithromboticDischarge.negationRationale in "Medical Reason For Not Providing Treatment"
	      or NoAntithromboticDischarge.negationRationale in "Patient Refusal"
*/
{% macro DischargedonAntithromboticTherapyReason_for_Not_Giving_Antithrombotic_at_Discharge(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapyReason for Not Giving Antithrombotic at Discharge', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'NoAntithromboticDischarge', 'path': 'negationRationale' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyMedical_Reason_For_Not_Providing_Treatment', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.473', 'referenceName': 'DischargedonAntithromboticTherapyMedical Reason For Not Providing Treatment' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'NoAntithromboticDischarge', 'path': 'negationRationale' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyPatient_Refusal', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.93', 'referenceName': 'DischargedonAntithromboticTherapyPatient Refusal' } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NoAntithromboticDischarge', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'NegativeMedicationDischarge', 'resultTypeLabel': 'Medication, Not Discharged', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyAntithrombotic_Therapy_for_Ischemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1110.62', 'referenceName': 'DischargedonAntithromboticTherapyAntithrombotic Therapy for Ischemic Stroke' } } } }] } }) }}{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [51:1-54:100]
	define "Numerator":
	  TJC."Ischemic Stroke Encounter" IschemicStrokeEncounter
	    with ["Medication, Discharge": "Antithrombotic Therapy for Ischemic Stroke"] DischargeAntithrombotic
	      such that DischargeAntithrombotic.authorDatetime during IschemicStrokeEncounter.relevantPeriod
*/
{% macro DischargedonAntithromboticTherapyNumerator(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapyNumerator', 'child': { 'operator': environment.Query, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'IschemicStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallIschemic_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIschemic Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } }, 'right': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'EncounterWithAge', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'EncounterWithAge', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallEncounter_with_Principal_Diagnosis_and_Age', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Principal Diagnosis and Age', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.GreaterOrEqual, 'left': { 'operator': environment.CalculateAgeAt, 'left': { 'operator': environment.ToDate, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'birthDatetime', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallPatient', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } } } } }, 'right': { 'operator': environment.DateFrom, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'AllStrokeEncounter', 'path': 'relevantPeriod' } } } }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '18' } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'AllStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallAll_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } } } }] } } } }] } } } }], 'relationshipClauseList': [{ 'operator': environment.With, 'alias': 'DischargeAntithrombotic', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveMedicationDischarge', 'resultTypeLabel': 'Medication, Discharge', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyAntithrombotic_Therapy_for_Ischemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1110.62', 'referenceName': 'DischargedonAntithromboticTherapyAntithrombotic Therapy for Ischemic Stroke' } } }, 'suchThat': { 'operator': environment.InInterval, 'left': { 'operator': environment.Property, 'scope': 'DischargeAntithrombotic', 'path': 'authorDatetime' }, 'right': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'relevantPeriod' } } }] } }) }}{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [56:1-59:102]
	define "Encounter with Documented Reason for No Antithrombotic At Discharge":
	  TJC."Ischemic Stroke Encounter" IschemicStrokeEncounter
	    with "Reason for Not Giving Antithrombotic at Discharge" NoDischargeAntithrombotic
	      such that NoDischargeAntithrombotic.authorDatetime during IschemicStrokeEncounter.relevantPeriod
*/
{% macro DischargedonAntithromboticTherapyEncounter_with_Documented_Reason_for_No_Antithrombotic_At_Discharge(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapyEncounter with Documented Reason for No Antithrombotic At Discharge', 'child': { 'operator': environment.Query, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'IschemicStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallIschemic_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIschemic Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } }, 'right': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'EncounterWithAge', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'EncounterWithAge', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallEncounter_with_Principal_Diagnosis_and_Age', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Principal Diagnosis and Age', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.GreaterOrEqual, 'left': { 'operator': environment.CalculateAgeAt, 'left': { 'operator': environment.ToDate, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'birthDatetime', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallPatient', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } } } } }, 'right': { 'operator': environment.DateFrom, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'AllStrokeEncounter', 'path': 'relevantPeriod' } } } }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '18' } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'AllStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallAll_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } } } }] } } } }] } } } }], 'relationshipClauseList': [{ 'operator': environment.With, 'alias': 'NoDischargeAntithrombotic', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'DischargedonAntithromboticTherapyReason_for_Not_Giving_Antithrombotic_at_Discharge', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapyReason for Not Giving Antithrombotic at Discharge', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'NoAntithromboticDischarge', 'path': 'negationRationale' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyMedical_Reason_For_Not_Providing_Treatment', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.473', 'referenceName': 'DischargedonAntithromboticTherapyMedical Reason For Not Providing Treatment' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'NoAntithromboticDischarge', 'path': 'negationRationale' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyPatient_Refusal', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.93', 'referenceName': 'DischargedonAntithromboticTherapyPatient Refusal' } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NoAntithromboticDischarge', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'NegativeMedicationDischarge', 'resultTypeLabel': 'Medication, Not Discharged', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyAntithrombotic_Therapy_for_Ischemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1110.62', 'referenceName': 'DischargedonAntithromboticTherapyAntithrombotic Therapy for Ischemic Stroke' } } } }] } } }, 'suchThat': { 'operator': environment.InInterval, 'left': { 'operator': environment.Property, 'scope': 'NoDischargeAntithrombotic', 'path': 'authorDatetime' }, 'right': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'relevantPeriod' } } }] } }) }}{% endmacro %}
/*
	// DischargedonAntithromboticTherapy lines [61:1-63:100]
	define "Denominator Exceptions":
	  "Encounter with Documented Reason for No Antithrombotic At Discharge"
	    union "Encounter with Pharmacological Contraindications for Antithrombotic Therapy at Discharge"
*/
{% macro DischargedonAntithromboticTherapyDenominator_Exceptions(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapyDenominator Exceptions', 'child': { 'operator': environment.Union, 'mixed': 'false', 'children': [{ 'operator': environment.ExpressionRef, 'referencedName': 'DischargedonAntithromboticTherapyEncounter_with_Documented_Reason_for_No_Antithrombotic_At_Discharge', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapyEncounter with Documented Reason for No Antithrombotic At Discharge', 'child': { 'operator': environment.Query, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'IschemicStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallIschemic_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIschemic Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } }, 'right': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'EncounterWithAge', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'EncounterWithAge', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallEncounter_with_Principal_Diagnosis_and_Age', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Principal Diagnosis and Age', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.GreaterOrEqual, 'left': { 'operator': environment.CalculateAgeAt, 'left': { 'operator': environment.ToDate, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'birthDatetime', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallPatient', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } } } } }, 'right': { 'operator': environment.DateFrom, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'AllStrokeEncounter', 'path': 'relevantPeriod' } } } }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '18' } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'AllStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallAll_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } } } }] } } } }] } } } }], 'relationshipClauseList': [{ 'operator': environment.With, 'alias': 'NoDischargeAntithrombotic', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'DischargedonAntithromboticTherapyReason_for_Not_Giving_Antithrombotic_at_Discharge', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapyReason for Not Giving Antithrombotic at Discharge', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'NoAntithromboticDischarge', 'path': 'negationRationale' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyMedical_Reason_For_Not_Providing_Treatment', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.473', 'referenceName': 'DischargedonAntithromboticTherapyMedical Reason For Not Providing Treatment' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'NoAntithromboticDischarge', 'path': 'negationRationale' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyPatient_Refusal', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.93', 'referenceName': 'DischargedonAntithromboticTherapyPatient Refusal' } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NoAntithromboticDischarge', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'NegativeMedicationDischarge', 'resultTypeLabel': 'Medication, Not Discharged', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyAntithrombotic_Therapy_for_Ischemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1110.62', 'referenceName': 'DischargedonAntithromboticTherapyAntithrombotic Therapy for Ischemic Stroke' } } } }] } } }, 'suchThat': { 'operator': environment.InInterval, 'left': { 'operator': environment.Property, 'scope': 'NoDischargeAntithrombotic', 'path': 'authorDatetime' }, 'right': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'relevantPeriod' } } }] } } }, { 'operator': environment.ExpressionRef, 'referencedName': 'DischargedonAntithromboticTherapyEncounter_with_Pharmacological_Contraindications_for_Antithrombotic_Therapy_at_Discharge', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'DischargedonAntithromboticTherapyEncounter with Pharmacological Contraindications for Antithrombotic Therapy at Discharge', 'child': { 'operator': environment.Query, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'IschemicStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallIschemic_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIschemic Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } }, 'right': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'EncounterWithAge', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'EncounterWithAge', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallEncounter_with_Principal_Diagnosis_and_Age', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Principal Diagnosis and Age', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.GreaterOrEqual, 'left': { 'operator': environment.CalculateAgeAt, 'left': { 'operator': environment.ToDate, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'birthDatetime', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallPatient', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } } } } }, 'right': { 'operator': environment.DateFrom, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'AllStrokeEncounter', 'path': 'relevantPeriod' } } } }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '18' } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'AllStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallAll_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } } } }] } } } }] } } } }], 'relationshipClauseList': [{ 'operator': environment.With, 'alias': 'Pharmacological', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveMedicationDischarge', 'resultTypeLabel': 'Medication, Discharge', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'DischargedonAntithromboticTherapyPharmacological_Contraindications_For_Antithrombotic_Therapy', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1110.52', 'referenceName': 'DischargedonAntithromboticTherapyPharmacological Contraindications For Antithrombotic Therapy' } } }, 'suchThat': { 'operator': environment.InInterval, 'left': { 'operator': environment.Property, 'scope': 'Pharmacological', 'path': 'authorDatetime' }, 'right': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'relevantPeriod' } } }] } } }] } }) }}{% endmacro %}
