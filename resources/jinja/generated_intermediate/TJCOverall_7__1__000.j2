/*
	// TJCOverall lines [7:1-7:65]
	valueset "Comfort Measures": 'urn:oid:1.3.6.1.4.1.33895.1.3.0.45' 
*/
{% macro TJCOverallComfort_Measures() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:1.3.6.1.4.1.33895.1.3.0.45', 'referenceName': 'TJCOverallComfort Measures' }{% endmacro %}
/*
	// TJCOverall lines [8:1-8:87]
	valueset "Discharge To Acute Care Facility": 'urn:oid:2.16.840.1.113883.3.117.1.7.1.87' 
*/
{% macro TJCOverallDischarge_To_Acute_Care_Facility() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.87', 'referenceName': 'TJCOverallDischarge To Acute Care Facility' }{% endmacro %}
/*
	// TJCOverall lines [9:1-9:107]
	valueset "Discharged to Health Care Facility for Hospice Care": 'urn:oid:2.16.840.1.113883.3.117.1.7.1.207' 
*/
{% macro TJCOverallDischarged_to_Health_Care_Facility_for_Hospice_Care() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.207', 'referenceName': 'TJCOverallDischarged to Health Care Facility for Hospice Care' }{% endmacro %}
/*
	// TJCOverall lines [10:1-10:91]
	valueset "Discharged to Home for Hospice Care": 'urn:oid:2.16.840.1.113883.3.117.1.7.1.209' 
*/
{% macro TJCOverallDischarged_to_Home_for_Hospice_Care() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.209', 'referenceName': 'TJCOverallDischarged to Home for Hospice Care' }{% endmacro %}
/*
	// TJCOverall lines [11:1-11:82]
	valueset "Emergency Department Visit": 'urn:oid:2.16.840.1.113883.3.117.1.7.1.292' 
*/
{% macro TJCOverallEmergency_Department_Visit() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.292', 'referenceName': 'TJCOverallEmergency Department Visit' }{% endmacro %}
/*
	// TJCOverall lines [12:1-12:74]
	valueset "Hemorrhagic Stroke": 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212' 
*/
{% macro TJCOverallHemorrhagic_Stroke() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' }{% endmacro %}
/*
	// TJCOverall lines [13:1-13:71]
	valueset "Ischemic Stroke": 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247' 
*/
{% macro TJCOverallIschemic_Stroke() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' }{% endmacro %}
/*
	// TJCOverall lines [14:1-14:83]
	valueset "Left Against Medical Advice": 'urn:oid:2.16.840.1.113883.3.117.1.7.1.308' 
*/
{% macro TJCOverallLeft_Against_Medical_Advice() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.308', 'referenceName': 'TJCOverallLeft Against Medical Advice' }{% endmacro %}
/*
	// TJCOverall lines [15:1-15:87]
	valueset "Nonelective Inpatient Encounter": 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424' 
*/
{% macro TJCOverallNonelective_Inpatient_Encounter() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' }{% endmacro %}
/*
	// TJCOverall lines [16:1-16:73]
	valueset "Observation Services": 'urn:oid:2.16.840.1.113762.1.4.1111.143' 
*/
{% macro TJCOverallObservation_Services() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'TJCOverallObservation Services' }{% endmacro %}
/*
	// TJCOverall lines [17:1-17:71]
	valueset "Patient Expired": 'urn:oid:2.16.840.1.113883.3.117.1.7.1.309' 
*/
{% macro TJCOverallPatient_Expired() %}{ 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.309', 'referenceName': 'TJCOverallPatient Expired' }{% endmacro %}
/*
	// TJCOverall lines [21:1-21:15]
	context Patient
*/
{% macro TJCOverallPatient(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } }) }}{% endmacro %}
/*
	// TJCOverall lines [23:1-25:57]
	define "Intervention Comfort Measures":
	  ["Intervention, Order": "Comfort Measures"]
	    union ["Intervention, Performed": "Comfort Measures"]
*/
{% macro TJCOverallIntervention_Comfort_Measures(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIntervention Comfort Measures', 'child': { 'operator': environment.Union, 'mixed': 'true', 'children': [{ 'operator': environment.As, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveInterventionOrder', 'resultTypeLabel': 'Intervention, Order', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallComfort_Measures', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:1.3.6.1.4.1.33895.1.3.0.45', 'referenceName': 'TJCOverallComfort Measures' } } }, 'typeSpecifier': { 'operator': environment.ListTypeSpecifier, 'children': [{ 'operator': environment.ChoiceTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveInterventionPerformed' }, { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveInterventionOrder' }] }] } }, { 'operator': environment.As, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveInterventionPerformed', 'resultTypeLabel': 'Intervention, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallComfort_Measures', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:1.3.6.1.4.1.33895.1.3.0.45', 'referenceName': 'TJCOverallComfort Measures' } } }, 'typeSpecifier': { 'operator': environment.ListTypeSpecifier, 'children': [{ 'operator': environment.ChoiceTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveInterventionPerformed' }, { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveInterventionOrder' }] }] } }] } }) }}{% endmacro %}
/*
	// TJCOverall lines [58:1-61:85]
	define "Non Elective Inpatient Encounter":
	  ["Encounter, Performed": "Nonelective Inpatient Encounter"] NonElectiveEncounter
	    where Global."LengthInDays" ( NonElectiveEncounter.relevantPeriod ) <= 120
	      and NonElectiveEncounter.relevantPeriod ends during day of "Measurement Period"
*/
{% macro TJCOverallNon_Elective_Inpatient_Encounter(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } }) }}{% endmacro %}
/*
	// TJCOverall lines [44:1-51:5]
	define "All Stroke Encounter":
	  "Non Elective Inpatient Encounter" NonElectiveEncounter
	    where exists ( NonElectiveEncounter.diagnoses Diagnosis
	        where Diagnosis.rank = 1
	          and ( Diagnosis.code in "Hemorrhagic Stroke"
	              or Diagnosis.code in "Ischemic Stroke"
	          )
	    )
*/
{% macro TJCOverallAll_Stroke_Encounter(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } }) }}{% endmacro %}
/*
	// TJCOverall lines [63:1-65:81]
	define "Encounter with Principal Diagnosis and Age":
	  "All Stroke Encounter" AllStrokeEncounter
	    where AgeInYearsAt(date from start of AllStrokeEncounter.relevantPeriod)>= 18
*/
{% macro TJCOverallEncounter_with_Principal_Diagnosis_and_Age(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Principal Diagnosis and Age', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.GreaterOrEqual, 'left': { 'operator': environment.CalculateAgeAt, 'left': { 'operator': environment.ToDate, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'birthDatetime', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallPatient', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } } } } }, 'right': { 'operator': environment.DateFrom, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'AllStrokeEncounter', 'path': 'relevantPeriod' } } } }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '18' } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'AllStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallAll_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } } } }] } }) }}{% endmacro %}
/*
	// TJCOverall lines [37:1-42:5]
	define "Ischemic Stroke Encounter":
	  "Encounter with Principal Diagnosis and Age" EncounterWithAge
	    where exists ( EncounterWithAge.diagnoses Diagnosis
	        where Diagnosis.code in "Ischemic Stroke"
	          and Diagnosis.rank = 1
	    )
*/
{% macro TJCOverallIschemic_Stroke_Encounter(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIschemic Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } }, 'right': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'EncounterWithAge', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'EncounterWithAge', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallEncounter_with_Principal_Diagnosis_and_Age', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Principal Diagnosis and Age', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.GreaterOrEqual, 'left': { 'operator': environment.CalculateAgeAt, 'left': { 'operator': environment.ToDate, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'birthDatetime', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallPatient', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } } } } }, 'right': { 'operator': environment.DateFrom, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'AllStrokeEncounter', 'path': 'relevantPeriod' } } } }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '18' } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'AllStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallAll_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } } } }] } } } }] } }) }}{% endmacro %}
/*
	// TJCOverall lines [27:1-35:3]
	define "Ischemic Stroke Encounters with Discharge Disposition":
	  ( ( "Ischemic Stroke Encounter" IschemicStrokeEncounter
	        where IschemicStrokeEncounter.dischargeDisposition in "Discharge To Acute Care Facility"
	          or IschemicStrokeEncounter.dischargeDisposition in "Left Against Medical Advice"
	          or IschemicStrokeEncounter.dischargeDisposition in "Patient Expired"
	          or IschemicStrokeEncounter.dischargeDisposition in "Discharged to Home for Hospice Care"
	          or IschemicStrokeEncounter.dischargeDisposition in "Discharged to Health Care Facility for Hospice Care"
	    )
	  )
*/
{% macro TJCOverallIschemic_Stroke_Encounters_with_Discharge_Disposition(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIschemic Stroke Encounters with Discharge Disposition', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Or, 'left': { 'operator': environment.Or, 'left': { 'operator': environment.Or, 'left': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'dischargeDisposition' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallDischarge_To_Acute_Care_Facility', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.87', 'referenceName': 'TJCOverallDischarge To Acute Care Facility' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'dischargeDisposition' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallLeft_Against_Medical_Advice', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.308', 'referenceName': 'TJCOverallLeft Against Medical Advice' } } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'dischargeDisposition' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallPatient_Expired', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.309', 'referenceName': 'TJCOverallPatient Expired' } } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'dischargeDisposition' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallDischarged_to_Home_for_Hospice_Care', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.209', 'referenceName': 'TJCOverallDischarged to Home for Hospice Care' } } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'IschemicStrokeEncounter', 'path': 'dischargeDisposition' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallDischarged_to_Health_Care_Facility_for_Hospice_Care', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.207', 'referenceName': 'TJCOverallDischarged to Health Care Facility for Hospice Care' } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'IschemicStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallIschemic_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIschemic Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } }, 'right': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'EncounterWithAge', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'EncounterWithAge', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallEncounter_with_Principal_Diagnosis_and_Age', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Principal Diagnosis and Age', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.GreaterOrEqual, 'left': { 'operator': environment.CalculateAgeAt, 'left': { 'operator': environment.ToDate, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'birthDatetime', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallPatient', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } } } } }, 'right': { 'operator': environment.DateFrom, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'AllStrokeEncounter', 'path': 'relevantPeriod' } } } }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '18' } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'AllStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallAll_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } } } }] } } } }] } } } }] } }) }}{% endmacro %}
/*
	// TJCOverall lines [53:1-56:230]
	define "Encounter with Comfort Measures during Hospitalization":
	  "Ischemic Stroke Encounter" IschemicStrokeEncounter
	    with "Intervention Comfort Measures" ComfortMeasure
	      such that Coalesce(start of Global."NormalizeInterval"(ComfortMeasure.relevantDatetime, ComfortMeasure.relevantPeriod), ComfortMeasure.authorDatetime)during Global."HospitalizationWithObservation" ( IschemicStrokeEncounter )
*/
{% macro TJCOverallEncounter_with_Comfort_Measures_during_Hospitalization(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Comfort Measures during Hospitalization', 'child': { 'operator': environment.Query, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'IschemicStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallIschemic_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIschemic Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } }, 'right': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'EncounterWithAge', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'EncounterWithAge', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallEncounter_with_Principal_Diagnosis_and_Age', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallEncounter with Principal Diagnosis and Age', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.GreaterOrEqual, 'left': { 'operator': environment.CalculateAgeAt, 'left': { 'operator': environment.ToDate, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'birthDatetime', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallPatient', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallPatient', 'child': { 'operator': environment.SingletonFrom, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'Patient', 'resultTypeLabel': none, 'codeComparator': none, 'codeProperty': none, 'codeSearch': none, 'valueSetProperty': none } } } } } }, 'right': { 'operator': environment.DateFrom, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'AllStrokeEncounter', 'path': 'relevantPeriod' } } } }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '18' } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'AllStrokeEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallAll_Stroke_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallAll Stroke Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.Exists, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.Equal, 'left': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'rank' }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '1' } }, 'right': { 'operator': environment.Or, 'left': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallHemorrhagic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.212', 'referenceName': 'TJCOverallHemorrhagic Stroke' } } }, 'right': { 'operator': environment.InValueSet, 'child': { 'operator': environment.Property, 'scope': 'Diagnosis', 'path': 'code' }, 'valueSetReference': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallIschemic_Stroke', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.247', 'referenceName': 'TJCOverallIschemic Stroke' } } } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Diagnosis', 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'diagnoses' } }] } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallNon_Elective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallNon Elective Inpatient Encounter', 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.LessOrEqual, 'left': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' }] }, 'right': { 'operator': environment.Literal, 'type': 'Integer', 'value': '120' } }, 'right': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'NonElectiveEncounter', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.ParameterRef, 'name': 'Measurement_Period' } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'NonElectiveEncounter', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallNonelective_Inpatient_Encounter', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.424', 'referenceName': 'TJCOverallNonelective Inpatient Encounter' } } } }] } } } }] } } } }] } } } }] } } } }], 'relationshipClauseList': [{ 'operator': environment.With, 'alias': 'ComfortMeasure', 'child': { 'operator': environment.ExpressionRef, 'referencedName': 'TJCOverallIntervention_Comfort_Measures', 'referenceTo': { 'operator': environment.ExpressionDef, 'context': 'Patient', 'referenceName': 'TJCOverallIntervention Comfort Measures', 'child': { 'operator': environment.Union, 'mixed': 'true', 'children': [{ 'operator': environment.As, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveInterventionOrder', 'resultTypeLabel': 'Intervention, Order', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallComfort_Measures', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:1.3.6.1.4.1.33895.1.3.0.45', 'referenceName': 'TJCOverallComfort Measures' } } }, 'typeSpecifier': { 'operator': environment.ListTypeSpecifier, 'children': [{ 'operator': environment.ChoiceTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveInterventionPerformed' }, { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveInterventionOrder' }] }] } }, { 'operator': environment.As, 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveInterventionPerformed', 'resultTypeLabel': 'Intervention, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'TJCOverallComfort_Measures', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:1.3.6.1.4.1.33895.1.3.0.45', 'referenceName': 'TJCOverallComfort Measures' } } }, 'typeSpecifier': { 'operator': environment.ListTypeSpecifier, 'children': [{ 'operator': environment.ChoiceTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveInterventionPerformed' }, { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveInterventionOrder' }] }] } }] } } }, 'suchThat': { 'operator': environment.InInterval, 'left': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsNormalizeInterval', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsNormalizeInterval', 'child': { 'operator': environment.If, 'condition': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.OperandRef, 'referencedName': 'pointInTime', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'pointInTime', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } } }, 'then': { 'operator': environment.Interval, 'high': { 'operator': environment.OperandRef, 'referencedName': 'pointInTime', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'pointInTime', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } }, 'low': { 'operator': environment.OperandRef, 'referencedName': 'pointInTime', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'pointInTime', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } }, 'else': { 'operator': environment.If, 'condition': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.OperandRef, 'referencedName': 'period', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'period', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'then': { 'operator': environment.OperandRef, 'referencedName': 'period', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'period', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } }, 'else': { 'operator': environment.As, 'child': { 'operator': environment.Null }, 'typeSpecifier': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'typeSpecifier': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'pointInTime', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } }, { 'operator': environment.OperandDef, 'referenceName': 'period', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.Property, 'scope': 'ComfortMeasure', 'path': 'relevantDatetime' }, { 'operator': environment.Property, 'scope': 'ComfortMeasure', 'path': 'relevantPeriod' }] } }, { 'operator': environment.Property, 'scope': 'ComfortMeasure', 'path': 'authorDatetime' }] }, 'right': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsHospitalizationWithObservation', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsHospitalizationWithObservation', 'child': { 'operator': environment.Query, 'returnClause': { 'operator': environment.ReturnClause, 'child': { 'operator': environment.Interval, 'high': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'EDVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'EDVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastED', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastED', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsEmergency_Department_Visit', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.292', 'referenceName': 'MATGlobalCommonFunctionsEmergency Department Visit' } } } }] } } } } } }, { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }] } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Visit', 'child': { 'operator': environment.OperandRef, 'referencedName': 'Encounter', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Encounter', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed' } } } }], 'letClauseList': [{ 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } }, { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } }, { 'operator': environment.LetClause, 'referenceName': 'EDVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastED', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastED', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsEmergency_Department_Visit', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.292', 'referenceName': 'MATGlobalCommonFunctionsEmergency Department Visit' } } } }] } } }] }, 'typeSpecifier': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Encounter', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed' } }] }, 'children': [{ 'operator': environment.AliasRef, 'referencedName': 'IschemicStrokeEncounter' }] } } }], 'aliasRefNodeList': [{ 'operator': environment.AliasRef, 'referencedName': 'IschemicStrokeEncounter' }] } }) }}{% endmacro %}
/*
	// TJCOverall lines [67:1-68:81]
	define function "HospitalizationWithObservationLengthofStay"(Encounter "Encounter, Performed" ):
	  Global."LengthInDays" ( Global."HospitalizationWithObservation" ( Encounter ) )
*/
{% macro TJCOverallHospitalizationWithObservationLengthofStay(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'TJCOverallHospitalizationWithObservationLengthofStay', 'child': { 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsLengthInDays', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsLengthInDays', 'child': { 'operator': environment.DifferenceBetween, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } }, 'right': { 'operator': environment.End, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] } }] }, 'children': [{ 'operator': environment.FunctionRef, 'referencedName': 'MATGlobalCommonFunctionsHospitalizationWithObservation', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'MATGlobalCommonFunctionsHospitalizationWithObservation', 'child': { 'operator': environment.Query, 'returnClause': { 'operator': environment.ReturnClause, 'child': { 'operator': environment.Interval, 'high': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'EDVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'EDVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastED', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastED', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsEmergency_Department_Visit', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.292', 'referenceName': 'MATGlobalCommonFunctionsEmergency Department Visit' } } } }] } } } } } }, { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }] } } }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'Visit', 'child': { 'operator': environment.OperandRef, 'referencedName': 'Encounter', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Encounter', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed' } } } }], 'letClauseList': [{ 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } }, { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } }, { 'operator': environment.LetClause, 'referenceName': 'EDVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastED', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'VisitStart', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'VisitStart', 'child': { 'operator': environment.Coalesce, 'children': [{ 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': none, 'path': 'relevantPeriod', 'child': { 'operator': environment.QueryLetRef, 'referencedName': 'ObsVisit', 'referenceTo': { 'operator': environment.LetClause, 'referenceName': 'ObsVisit', 'child': { 'operator': environment.Last, 'child': { 'operator': environment.Query, 'where': { 'operator': environment.And, 'left': { 'operator': environment.InInterval, 'left': { 'operator': environment.End, 'child': { 'operator': environment.Property, 'scope': 'LastObs', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Interval, 'high': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'low': { 'operator': environment.Subtract, 'left': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }, 'right': { 'operator': environment.Quantity, 'unit': 'hour', 'value': '1' } } } }, 'right': { 'operator': environment.Not, 'child': { 'operator': environment.IsNull, 'child': { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastObs', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsObservation_Services', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113762.1.4.1111.143', 'referenceName': 'MATGlobalCommonFunctionsObservation Services' } } } }] } } } } } }, { 'operator': environment.Start, 'child': { 'operator': environment.Property, 'scope': 'Visit', 'path': 'relevantPeriod' } }] } } } } } }, 'sortClause': { 'operator': environment.SortClause, 'children': [{ 'operator': environment.ByExpression, 'direction': 'ASC', 'child': { 'operator': environment.End, 'child': { 'operator': environment.IdentifierRef, 'referencedName': 'relevantPeriod', 'resultType': 'interval<System.DateTime>' } } }] }, 'aliasedQuerySources': [{ 'operator': environment.AliasedQuerySource, 'alias': 'LastED', 'child': { 'operator': environment.Retrieve, 'modelType': 'urn:healthit-gov:qdm:v5_6', 'templateId': 'PositiveEncounterPerformed', 'resultTypeLabel': 'Encounter, Performed', 'codeComparator': 'in', 'codeProperty': 'code', 'codeSearch': none, 'valueSetProperty': none, 'valueSet': { 'operator': environment.ValueSetRef, 'referencedName': 'MATGlobalCommonFunctionsEmergency_Department_Visit', 'referenceTo': { 'operator': environment.ValueSetDef, 'value': 'urn:oid:2.16.840.1.113883.3.117.1.7.1.292', 'referenceName': 'MATGlobalCommonFunctionsEmergency Department Visit' } } } }] } } }] }, 'typeSpecifier': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Encounter', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed' } }] }, 'children': [{ 'operator': environment.OperandRef, 'referencedName': 'Encounter', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Encounter', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed' } } }] }] }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Encounter', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed' } }] }) }}{% endmacro %}
/*
	// TJCOverall lines [70:1-71:100]
	define function "TruncateTime"(Value DateTime ):
	  DateTime(year from Value, month from Value, day from Value, 0, 0, 0, 0, timezoneoffset from Value)
*/
{% macro TJCOverallTruncateTime(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'TJCOverallTruncateTime', 'child': { 'operator': environment.DateTime, 'year': { 'operator': environment.DateTimeComponentFrom, 'precision': 'YEAR', 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } }, 'month': { 'operator': environment.DateTimeComponentFrom, 'precision': 'MONTH', 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } }, 'day': { 'operator': environment.DateTimeComponentFrom, 'precision': 'DAY', 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } }, 'hour': { 'operator': environment.Literal, 'type': 'Integer', 'value': '0' }, 'minute': { 'operator': environment.Literal, 'type': 'Integer', 'value': '0' }, 'second': { 'operator': environment.Literal, 'type': 'Integer', 'value': '0' }, 'millisecond': { 'operator': environment.Literal, 'type': 'Integer', 'value': '0' }, 'timezoneOffset': { 'operator': environment.TimezoneOffsetFrom, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } }] }) }}{% endmacro %}
/*
	// TJCOverall lines [73:1-74:75]
	define function "CalendarDayOfOrDayAfter"(StartValue DateTime ):
	  Interval["TruncateTime"(StartValue), "TruncateTime"(StartValue + 2 days))
*/
{% macro TJCOverallCalendarDayOfOrDayAfter(environment, state) %}{{ environment.OperatorHandler.print(environment, environment.OperatorHandler, state, { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'TJCOverallCalendarDayOfOrDayAfter', 'child': { 'operator': environment.Interval, 'high': { 'operator': environment.FunctionRef, 'referencedName': 'TJCOverallTruncateTime', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'TJCOverallTruncateTime', 'child': { 'operator': environment.DateTime, 'year': { 'operator': environment.DateTimeComponentFrom, 'precision': 'YEAR', 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } }, 'month': { 'operator': environment.DateTimeComponentFrom, 'precision': 'MONTH', 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } }, 'day': { 'operator': environment.DateTimeComponentFrom, 'precision': 'DAY', 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } }, 'hour': { 'operator': environment.Literal, 'type': 'Integer', 'value': '0' }, 'minute': { 'operator': environment.Literal, 'type': 'Integer', 'value': '0' }, 'second': { 'operator': environment.Literal, 'type': 'Integer', 'value': '0' }, 'millisecond': { 'operator': environment.Literal, 'type': 'Integer', 'value': '0' }, 'timezoneOffset': { 'operator': environment.TimezoneOffsetFrom, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } }] }, 'children': [{ 'operator': environment.Add, 'left': { 'operator': environment.OperandRef, 'referencedName': 'StartValue', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'StartValue', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } }, 'right': { 'operator': environment.Quantity, 'unit': 'days', 'value': '2' } }] }, 'low': { 'operator': environment.FunctionRef, 'referencedName': 'TJCOverallTruncateTime', 'referenceTo': { 'operator': environment.FunctionDef, 'context': 'Patient', 'referenceName': 'TJCOverallTruncateTime', 'child': { 'operator': environment.DateTime, 'year': { 'operator': environment.DateTimeComponentFrom, 'precision': 'YEAR', 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } }, 'month': { 'operator': environment.DateTimeComponentFrom, 'precision': 'MONTH', 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } }, 'day': { 'operator': environment.DateTimeComponentFrom, 'precision': 'DAY', 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } }, 'hour': { 'operator': environment.Literal, 'type': 'Integer', 'value': '0' }, 'minute': { 'operator': environment.Literal, 'type': 'Integer', 'value': '0' }, 'second': { 'operator': environment.Literal, 'type': 'Integer', 'value': '0' }, 'millisecond': { 'operator': environment.Literal, 'type': 'Integer', 'value': '0' }, 'timezoneOffset': { 'operator': environment.TimezoneOffsetFrom, 'child': { 'operator': environment.OperandRef, 'referencedName': 'Value', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } } } }, 'typeSpecifier': { 'operator': environment.Disabled }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'Value', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } }] }, 'children': [{ 'operator': environment.OperandRef, 'referencedName': 'StartValue', 'referenceTo': { 'operator': environment.OperandDef, 'referenceName': 'StartValue', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } } }] } }, 'typeSpecifier': { 'operator': environment.IntervalTypeSpecifier, 'children': [{ 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' }] }, 'arguments': [{ 'operator': environment.OperandDef, 'referenceName': 'StartValue', 'child': { 'operator': environment.NamedTypeSpecifier, 'name': '{urn:hl7-org:elm-types:r1}DateTime' } }] }) }}{% endmacro %}
